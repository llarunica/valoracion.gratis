<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Valoración Inmobiliaria</title>
    <link rel="stylesheet" href="style.css">
    
</head>
<body>
    <div class="container">
        <h1>Valoración de Vivienda</h1>
        <form id="valuationForm">
            <div class="form-section">
                <h2>Datos de Contacto</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="name">Nombre completo *</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono *</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Correo electrónico *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2>Datos del Inmueble</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="location">Ciudad *</label>
                        <input type="text" id="location" name="location" required>
                    </div>
                    <div class="form-group">
                        <label for="type">Tipo de Vivienda *</label>
                        <select id="type" name="type" required>
                            <option value="">Seleccione tipo</option>
                            <option value="piso">Piso</option>
                            <option value="casa">Casa Unifamiliar</option>
                            <option value="duplex">Dúplex</option>
                            <option value="atico">Ático</option>
                            <option value="estudio">Estudio</option>
                        </select>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="size">Tamaño (m²) *</label>
                        <input type="number" id="size" name="size" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="age">Antigüedad (años) *</label>
                        <input type="number" id="age" name="age" min="0" required>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="bedrooms">Habitaciones *</label>
                        <input type="number" id="bedrooms" name="bedrooms" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="bathrooms">Baños *</label>
                        <input type="number" id="bathrooms" name="bathrooms" min="0" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="condition">Estado de Conservación *</label>
                    <select id="condition" name="condition" required>
                        <option value="">Seleccione estado</option>
                        <option value="excelente">Excelente</option>
                        <option value="bueno">Bueno</option>
                        <option value="regular">Regular</option>
                        <option value="malo">Malo</option>
                    </select>
                </div>
            </div>

            <div class="form-section">
                <h2>Características Adicionales</h2>
                <div class="amenities-grid">
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="pool"> Piscina
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="garage"> Garaje
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="garden"> Jardín
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="storage"> Trastero
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="elevator"> Ascensor
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="security"> Seguridad 24h
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="ac"> Aire Acondicionado
                    </label>
                    <label class="amenity-item">
                        <input type="checkbox" name="amenities" value="heating"> Calefacción
                    </label>
                </div>
            </div>

            <div class="form-section">
                <h2>Documentación</h2>
                <div class="form-group">
                    <label>Imágenes (máx. 5)</label>
                    <div class="file-upload">
                        <input type="file" id="images" accept="image/*" multiple style="display: none">
                        <button type="button" class="upload-btn" onclick="document.getElementById('images').click()">
                            Subir imágenes
                        </button>
                        <span id="imageCount">0/5</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="comments">Observaciones</label>
                    <textarea id="comments" name="comments" rows="3"></textarea>
                </div>
            </div>

            <button type="submit" class="submit-btn">Calcular Valor Aproximado</button>

            <div id="result" class="result">
                <p class="result-value"></p>
                <p class="result-note">*Este es un valor aproximado basado en los datos proporcionados y las condiciones actuales del mercado</p>
            </div>
        </form>
    </div>

    <script>
        const form = document.getElementById('valuationForm');
        const result = document.getElementById('result');
        const imageInput = document.getElementById('images');
        const imageCount = document.getElementById('imageCount');

        // Precios base por ciudad (2024)
        const baseLocationPrices = {
            'madrid': 3500,
            'barcelona': 3800,
            'valencia': 2200,
            'sevilla': 2000,
            'bilbao': 2800,
            'malaga': 2400,
            'default': 2500
        };

        const typeMultipliers = {
            'piso': 1.0,
            'casa': 1.3,
            'duplex': 1.2,
            'atico': 1.4,
            'estudio': 0.9
        };

        const conditionMultipliers = {
            'excelente': 1.2,
            'bueno': 1.0,
            'regular': 0.8,
            'malo': 0.6
        };

        const amenityValues = {
            'pool': 30000,
            'garage': 25000,
            'garden': 20000,
            'storage': 10000,
            'elevator': 15000,
            'security': 12000,
            'ac': 8000,
            'heating': 6000
        };

        // Validación de imágenes
        imageInput.addEventListener('change', function(e) {
            const files = e.target.files;
            if (files.length > 5) {
                alert('Máximo 5 imágenes permitidas');
                imageInput.value = '';
            }
            imageCount.textContent = `${Math.min(files.length, 5)}/5`;
        });

        // Validación del formulario
        function validateForm() {
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            
            const phoneRegex = /^[0-9]{9}$/;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            
            if (!phoneRegex.test(phone)) {
                alert('Por favor, introduce un número de teléfono válido (9 dígitos)');
                return false;
            }
            
            if (!emailRegex.test(email)) {
                alert('Por favor, introduce un correo electrónico válido');
                return false;
            }
            
            return true;
        }

        // Cálculo de la valoración
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateForm()) {
                return;
            }

            const formData = new FormData(form);
            const location = formData.get('location').toLowerCase();
            const type = formData.get('type');
            const age = parseFloat(formData.get('age'));
            const size = parseFloat(formData.get('size'));
            const bedrooms = parseFloat(formData.get('bedrooms'));
            const bathrooms = parseFloat(formData.get('bathrooms'));
            const condition = formData.get('condition');
            const amenities = formData.getAll('amenities');

            // Cálculo del precio base
            const basePrice = (baseLocationPrices[location] || baseLocationPrices.default) * size;

            // Factor por antigüedad
            const ageFactor = Math.max(0.7, 1 - (age * 0.01));

            // Factor por habitaciones y baños
            const bedroomMultiplier = 1 + ((bedrooms - 2) * 0.1);
            const bathroomMultiplier = 1 + ((bathrooms - 1) * 0.1);

            // Precio ajustado
            let adjustedPrice = basePrice * 
                typeMultipliers[type] * 
                ageFactor * 
                conditionMultipliers[condition] *
                bedroomMultiplier *
                bathroomMultiplier;

            // Ajuste por tamaño
            if (size > 150) adjustedPrice *= 0.95;
            if (size > 300) adjustedPrice *= 0.9;

            // Valor de amenidades
            const amenitiesValue = amenities.reduce((acc, amenity) => 
                acc + (amenityValues[amenity] || 0), 0);

            // Precio final con ajuste de mercado
            const finalPrice = (adjustedPrice + amenitiesValue) * 1.05;

            // Mostrar resultado
            result.classList.add('visible');
            result.querySelector('.result-value').textContent = 
                `Valor estimado: ${Math.round(finalPrice).toLocaleString('es-ES')} €`;
        });
    </script>
</body>
</html>
